<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>PROMarket ‚Äî Premium Service</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Leaflet CSS –∏ JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <!-- Particles.js, GSAP, Chart.js -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>
    <!-- –§–æ–Ω —Å —á–∞—Å—Ç–∏—Ü–∞–º–∏ -->
    <div id="particles-js"></div>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="progress-bar"></div>

    <header>
        <div class="logo"><i class="fas fa-bolt"></i> PROMarket</div>
        <div class="search-bar">
            <i class="fas fa-search" style="color:#94a3b8"></i>
            <input type="text" id="main-search" placeholder="–ü–æ–∏—Å–∫ –º–∞—Å—Ç–µ—Ä–æ–≤..." autofocus oninput="debounce(getPros, 500)()">
        </div>
        <div style="display: flex; align-items: center;">
            <div class="notification-badge" id="notificationBell" onclick="showNotifications()" title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                <i class="fas fa-bell fa-lg"></i>
                <span class="badge hidden" id="notificationCount">0</span>
            </div>
            <div id="auth-zone">
                <button class="btn btn-outline" id="authBtn" onclick="handleAuthAction()" title="–í–æ–π—Ç–∏ / –í—ã–π—Ç–∏">
                    <i class="fas fa-user-circle"></i> <span>–í–æ–π—Ç–∏</span>
                </button>
            </div>
            <!-- –ö–Ω–æ–ø–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è -->
            <button id="compare-btn" class="btn btn-outline" style="margin-left:10px;" title="–°—Ä–∞–≤–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤">
                <i class="fas fa-balance-scale"></i>
            </button>
            <!-- –ö–Ω–æ–ø–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö) -->
            <button id="filter-toggle" class="btn btn-outline" style="margin-left:10px;" title="–§–∏–ª—å—Ç—Ä—ã">
                <i class="fas fa-sliders-h"></i>
            </button>
            <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
            <button id="theme-toggle" class="btn btn-outline" style="margin-left:10px;" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                <i class="fas fa-moon"></i>
            </button>
            <!-- –ì–∞–º–±—É—Ä–≥–µ—Ä-–º–µ–Ω—é -->
            <button id="menu-toggle" class="btn btn-outline" style="margin-left:10px;" title="–ú–µ–Ω—é">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- –í—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é –≥–∞–º–±—É—Ä–≥–µ—Ä–∞ (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏) -->
    <div id="hamburger-menu" class="hamburger-menu hidden">
        <ul>
            <li onclick="openCompareFromMenu()"><i class="fas fa-balance-scale"></i> –°—Ä–∞–≤–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö</li>
            <li onclick="clearAllFavorites()"><i class="fas fa-heart-broken"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</li>
            <li onclick="showStatistics()"><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</li>
            <li onclick="randomMaster()"><i class="fas fa-random"></i> –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Ç–µ—Ä</li>
            <li onclick="showAbout()"><i class="fas fa-info-circle"></i> –û –ø—Ä–æ–µ–∫—Ç–µ</li>
        </ul>
    </div>

    <div class="app-container">
        <aside class="sidebar">
            <div style="display: flex; justify-content: flex-end; padding: 10px;">
                <button id="sidebar-close" class="btn btn-outline" style="padding: 8px 12px;">‚úï</button>
            </div>
            <div id="map" class="styled-map"></div>
            <div class="tabs-nav">
                <button class="tab-btn active" id="t-pros" onclick="showView('pros')" title="–°–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤">–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã</button>
                <button class="tab-btn" id="t-orders" onclick="showView('orders')" title="–í–∞—à–∏ –∑–∞–∫–∞–∑—ã">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
            </div>
            <div class="filter-content">
                <div class="filter-group">
                    <label title="–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é">–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥</label>
                    <select id="f-cat" onchange="getPros()">
                        <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="–†–µ–º–æ–Ω—Ç">üõ† –†–µ–º–æ–Ω—Ç</option>
                        <option value="–£–±–æ—Ä–∫–∞">üßπ –£–±–æ—Ä–∫–∞</option>
                        <option value="IT">üíª IT-—É—Å–ª—É–≥–∏</option>
                        <option value="–ö—Ä–∞—Å–æ—Ç–∞">‚ú® –ö—Ä–∞—Å–æ—Ç–∞</option>
                        <option value="–ü–µ—Ä–µ–µ–∑–¥—ã">üì¶ –ü–µ—Ä–µ–µ–∑–¥—ã</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label title="–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥</label>
                    <select id="f-rate" onchange="getPros()">
                        <option value="0">–õ—é–±–æ–π</option>
                        <option value="4.5">–í—ã—Å–æ–∫–∏–π (4.5+ ‚òÖ)</option>
                        <option value="4.8">–≠–ª–∏—Ç–Ω—ã–π (4.8+ ‚òÖ)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label title="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (‚ÇΩ)</label>
                    <input type="number" id="f-price" placeholder="–õ—é–±–∞—è" oninput="getPros()">
                </div>
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="f-verified" onchange="getPros()"> –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ
                    </label>
                </div>
                <div class="filter-group">
                    <label>
                        <input type="checkbox" id="f-favorites" onchange="getPros()"> –¢–æ–ª—å–∫–æ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
                    </label>
                </div>
                <div class="filter-group">
                    <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                    <select id="f-sort" onchange="getPros()">
                        <option value="default">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                        <option value="price_asc">–¶–µ–Ω–∞ (—Å–Ω–∞—á–∞–ª–∞ –¥–µ—à—ë–≤—ã–µ)</option>
                        <option value="price_desc">–¶–µ–Ω–∞ (—Å–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–≥–∏–µ)</option>
                        <option value="rating_desc">–†–µ–π—Ç–∏–Ω–≥ (—Å–Ω–∞—á–∞–ª–∞ –≤—ã—Å–æ–∫–∏–π)</option>
                        <option value="distance_asc">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–±–ª–∏–∂–µ)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <button class="btn btn-outline" onclick="resetFilters()" style="width:100%;">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                </div>
            </div>
        </aside>

        <main class="main" id="main-content">
            <div id="view-pros" class="view">
                <div id="pros-loader" class="loader hidden">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤...</div>
                <div id="pros-list" class="grid"></div>
            </div>
            <div id="view-orders" class="view hidden">
                <div id="orders-loader" class="loader hidden">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</div>
                <div id="orders-list" class="grid"></div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã) -->
    <div class="modal-bg" id="modal-auth">
        <div class="modal-box">
            <h2>–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!</h2>
            <p style="color:var(--text-muted)">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å—É</p>
            <input type="email" id="auth-email" placeholder="Email">
            <input type="password" id="auth-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn btn-primary" style="margin-top:25px" onclick="doLogin()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
            <button class="btn btn-outline" style="width:100%; margin-top:12px" onclick="closeModal('modal-auth')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="modal-bg" id="modal-booking">
        <div class="modal-box">
            <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
            <p id="book-info" style="color:var(--primary); font-weight:700"></p>
            <label>–î–∞—Ç–∞ –≤–∏–∑–∏—Ç–∞</label>
            <input type="date" id="book-date">
            <label>–í—Ä–µ–º—è</label>
            <input type="time" id="book-time">
            <label>–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?</label>
            <textarea id="book-comment" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É..."></textarea>
            <label>–ü—Ä–æ–º–æ–∫–æ–¥</label>
            <input type="text" id="promo-code" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
            <div id="promo-message" style="font-size:0.8rem; color:red; margin:5px 0; min-height:20px;"></div>
            <button class="btn btn-outline" onclick="applyPromo()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
            <button class="btn btn-primary" style="margin-top:25px" onclick="confirmBooking()">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä—É</button>
            <button class="btn btn-outline" style="width:100%; margin-top:12px" onclick="closeModal('modal-booking')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <div class="modal-bg" id="modal-notifications">
        <div class="modal-box">
            <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            <div id="notifications-list"></div>
            <button class="btn btn-outline" style="width:100%; margin-top:12px" onclick="closeModal('modal-notifications')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="modal-bg" id="modal-chat">
        <div class="modal-box">
            <h2 id="chat-with"></h2>
            <div class="chat-messages" id="chat-messages"></div>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chat-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex: 1;">
                <button class="btn btn-primary" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
            <button class="btn btn-outline" style="width:100%; margin-top:12px" onclick="closeModal('modal-chat')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è -->
    <div id="compare-modal" class="modal-bg" style="display:none;">
        <div class="modal-box" style="width:800px; max-width:95%;">
            <h2>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–æ–≤</h2>
            <div id="compare-content"></div>
            <button class="btn btn-outline" onclick="closeCompareModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="toast-container"></div>

    <!-- –ö–Ω–æ–ø–∫–∞ "–ù–∞–≤–µ—Ä—Ö" -->
    <button id="scrollTop" class="btn btn-primary" title="–ù–∞–≤–µ—Ä—Ö">‚Üë</button>

    <script src="client.js"></script>
</body>
</html>